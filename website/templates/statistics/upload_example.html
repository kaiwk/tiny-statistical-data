{% extends 'base.html' %}

{% block title_block %}
  Publish table
{% endblock %}

{% block body_block %}
  <p>
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <script type="text/javascript">
         var messages = {{ messages | safe }};
         for (var i=0; i < messages.length; i++) {
             alert(messages[i]);
         }
        </script>
      {% endif %}
    {% endwith %}
  </p>

  {% if table_head %}
    <h1>Success!</h1>
    <table class="table table-bordered">
      <caption>Example</caption>
      <thead>
	<tr>
	  {% for e in table_head %}
	    <th>{{ e }}</th>
	  {% endfor %}
	</tr>
      </thead>
      <tbody>
	{% for row in table_rows %}
	  <tr>
	    {% for e in row %}
	      <td>{{ e }}</td>
	    {% endfor %}
	  </tr>
	{% endfor %}
      </tbody>
    </table>

    <form action="{{ url_for('statistics.publish_table') }}" method="post">
      <input type="hidden" name="table_head" value="{{ table_head }}">
      <input type="hidden" name="table_rows" value="{{ table_rows }}">
      <input type="submit" value="confirm">
    </form>

  {% else %}
    <h1>publish table</h1>
    <form method="post" enctype="multipart/form-data">
      <p>
	<input type="file" name="file" accept=".csv">
	<input type="submit" value="upload">
      </p>
    </form>
  {% endif %}

{% endblock %}
